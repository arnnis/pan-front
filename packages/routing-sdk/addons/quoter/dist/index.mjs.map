{"version":3,"sources":["../src/constants/mixedRouteQuoterV1.ts","../src/constants/v3Quoter.ts","../src/utils/encodeRouteToPath.ts","../src/utils/isMixedRoute.ts","../src/utils/isV3Route.ts","../src/fetchV3Quote.ts","../src/abis/IQuoterV2.ts","../src/fetchQuotes.ts","../src/fetchMixedRouteQuote.ts","../src/abis/IMixedRouteQuoterV1.ts"],"names":["ChainId","isV3Pool","CurrencyAmount"],"mappings":";AAAA,SAAS,eAAe;AAIjB,IAAM,6BAA6B;AAEnC,IAAM,+BAA+B;AAAA,EAC1C,CAAC,QAAQ,QAAQ,GAAG;AAAA,EACpB,CAAC,QAAQ,MAAM,GAAG;AAAA,EAClB,CAAC,QAAQ,GAAG,GAAG;AAAA,EACf,CAAC,QAAQ,WAAW,GAAG;AAAA,EACvB,CAAC,QAAQ,YAAY,GAAG;AAAA,EACxB,CAAC,QAAQ,eAAe,GAAG;AAAA,EAC3B,CAAC,QAAQ,aAAa,GAAG;AAAA,EACzB,CAAC,QAAQ,qBAAqB,GAAG;AAAA,EACjC,CAAC,QAAQ,MAAM,GAAG;AAAA,EAClB,CAAC,QAAQ,cAAc,GAAG;AAAA,EAC1B,CAAC,QAAQ,KAAK,GAAG;AAAA,EACjB,CAAC,QAAQ,aAAa,GAAG;AAAA,EACzB,CAAC,QAAQ,KAAK,GAAG;AAAA,EACjB,CAAC,QAAQ,aAAa,GAAG;AAAA,EACzB,CAAC,QAAQ,IAAI,GAAG;AAAA,EAChB,CAAC,QAAQ,YAAY,GAAG;AAAA,EACxB,CAAC,QAAQ,cAAc,GAAG;AAAA,EAC1B,CAAC,QAAQ,OAAO,GAAG;AAAA,EACnB,CAAC,QAAQ,gBAAgB,GAAG;AAAA,EAC5B,CAAC,QAAQ,YAAY,GAAG;AAAA,EACxB,CAAC,QAAQ,aAAa,GAAG;AAC3B;;;AC5BA,SAAS,WAAAA,gBAAe;AAGjB,IAAM,sBAAsB;AAAA,EACjC,CAACA,SAAQ,QAAQ,GAAG;AAAA,EACpB,CAACA,SAAQ,MAAM,GAAG;AAAA,EAClB,CAACA,SAAQ,GAAG,GAAG;AAAA,EACf,CAACA,SAAQ,WAAW,GAAG;AAAA,EACvB,CAACA,SAAQ,YAAY,GAAG;AAAA,EACxB,CAACA,SAAQ,eAAe,GAAG;AAAA,EAC3B,CAACA,SAAQ,aAAa,GAAG;AAAA,EACzB,CAACA,SAAQ,qBAAqB,GAAG;AAAA,EACjC,CAACA,SAAQ,MAAM,GAAG;AAAA,EAClB,CAACA,SAAQ,cAAc,GAAG;AAAA,EAC1B,CAACA,SAAQ,KAAK,GAAG;AAAA,EACjB,CAACA,SAAQ,aAAa,GAAG;AAAA,EACzB,CAACA,SAAQ,KAAK,GAAG;AAAA,EACjB,CAACA,SAAQ,aAAa,GAAG;AAAA,EACzB,CAACA,SAAQ,IAAI,GAAG;AAAA,EAChB,CAACA,SAAQ,YAAY,GAAG;AAAA,EACxB,CAACA,SAAQ,cAAc,GAAG;AAAA,EAC1B,CAACA,SAAQ,OAAO,GAAG;AAAA,EACnB,CAACA,SAAQ,gBAAgB,GAAG;AAAA,EAC5B,CAACA,SAAQ,YAAY,GAAG;AAAA,EACxB,CAACA,SAAQ,aAAa,GAAG;AAC3B;;;ACzBA,SAAmB,oBAAoB;AAGvC,SAAS,gBAAgB;AAUlB,SAAS,kBAAkB,OAAmB,aAA2B;AAC9E,QAAM,kBAAyB,MAAM,KAAK,CAAC,EAAE;AAE7C,QAAM,EAAE,MAAM,MAAM,IAAI,MAAM,MAAM;AAAA,IAClC,CACE,EAAE,YAAY,MAAM,GAAG,OAAO,EAAE,GAChC,MACA,UACsE;AACtE,YAAM,cAAc,MAAM,KAAK,QAAQ,CAAC,EAAE;AAC1C,YAAM,MAAM,SAAS,IAAI,IAAI,KAAK,YAAY,EAAE,MAAM;AACtD,UAAI,UAAU,GAAG;AACf,eAAO;AAAA,UACL,YAAY;AAAA,UACZ,OAAO,CAAC,WAAW,UAAU,SAAS;AAAA,UACtC,MAAM,CAAC,WAAW,SAAS,KAAK,YAAY,OAAO;AAAA,QACrD;AAAA,MACF;AACA,aAAO;AAAA,QACL,YAAY;AAAA,QACZ,OAAO,CAAC,GAAG,GAAG,UAAU,SAAS;AAAA,QACjC,MAAM,CAAC,GAAG,GAAG,KAAK,YAAY,OAAO;AAAA,MACvC;AAAA,IACF;AAAA,IACA,EAAE,YAAY,iBAAiB,MAAM,CAAC,GAAG,OAAO,CAAC,EAAE;AAAA,EACrD;AAEA,SAAO,cAAc,aAAa,MAAM,QAAQ,GAAG,KAAK,QAAQ,CAAC,IAAI,aAAa,OAAO,IAAI;AAC/F;;;ACnCO,SAAS,aAAoC,EAAE,MAAM,GAAsB;AAChF,MAAI;AACJ,aAAW,KAAK,OAAO;AACrB,QAAI,aAAa,QAAW;AAC1B,iBAAW,EAAE;AACb;AAAA,IACF;AACA,QAAI,aAAa,EAAE,MAAM;AACvB,aAAO;AAAA,IACT;AAAA,EACF;AACA,SAAO;AACT;;;ACjBA,SAAS,YAAAC,iBAAgB;AAMlB,SAAS,UAAiC,EAAE,MAAM,GAAsB;AAC7E,SAAO,MAAM,MAAM,CAAC,MAAMA,UAAS,CAAC,CAAC;AACvC;;;ACLA,SAAS,sBAAsB;;;ACJxB,IAAM,cAAc;AAAA,EACzB;AAAA,IACE,QAAQ;AAAA,MACN;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,MACA;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,IACF;AAAA,IACA,MAAM;AAAA,IACN,SAAS;AAAA,MACP;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,MACA;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,MACA;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,MACA;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,IACF;AAAA,IACA,iBAAiB;AAAA,IACjB,MAAM;AAAA,EACR;AAAA,EACA;AAAA,IACE,QAAQ;AAAA,MACN;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,MACA;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,IACF;AAAA,IACA,MAAM;AAAA,IACN,SAAS;AAAA,MACP;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,MACA;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,MACA;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,MACA;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,IACF;AAAA,IACA,iBAAiB;AAAA,IACjB,MAAM;AAAA,EACR;AACF;;;ADlEO,SAAS,iBAA0D,OAAsB;AAC9F,QAAM,EAAE,MAAM,OAAO,IAAI;AACzB,QAAM;AAAA,IACJ,UAAU,EAAE,QAAQ;AAAA,EACtB,IAAI;AACJ,QAAM,aAAa,KAAK,KAAK,SAAS,CAAC,EAAE,QAAQ,OAAO,OAAO,SAAS,OAAO;AAC/E,SAAO;AAAA,IACL,SAAS,oBAAoB,OAAkB;AAAA,IAC/C,KAAK;AAAA,IACL,cAAc,aAAa,qBAAqB;AAAA,IAChD,MAAM,CAAC,kBAAkB,OAAO,UAAU,GAAG,OAAO,QAAQ;AAAA,EAC9D;AACF;AAEO,IAAM,eAA0C,OAAO,EAAE,OAAO,OAAO,MAAM;AAClF,QAAM,EAAE,MAAM,OAAO,IAAI;AACzB,QAAM,aAAa,KAAK,KAAK,SAAS,CAAC,EAAE,QAAQ,OAAO,OAAO,SAAS,OAAO;AAC/E,QAAM,SAAS,MAAM,OAAO,UAAU;AAAA,IACpC,WAAW,CAAC,iBAAgC,KAAK,CAAC;AAAA,IAClD,cAAc;AAAA,EAChB,CAAC;AAED,QAAM,CAAC,CAAC,OAAO,EAAE,EAAE,cAAc,CAAC,IAAI;AACtC,QAAM,cAAc,aAAa,KAAK,CAAC,IAAI,KAAK,KAAK,SAAS,CAAC;AAC/D,SAAO;AAAA,IACL,OAAO,eAAe,cAAc,aAAa,KAAK;AAAA,IACtD;AAAA,EACF;AACF;;;AEzCA,SAAS,kBAAAC,uBAAsB;;;ACC/B,SAAqB,oBAAoB;AACzC,SAAiB,gBAAgB;AACjC,SAAiB,YAAAD,iBAAgB;AACjC,OAAO,eAAe;;;ACJf,IAAM,wBAAwB;AAAA,EACnC;AAAA,IACE,QAAQ;AAAA,MACN;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,MACA;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,MACA;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,IACF;AAAA,IACA,MAAM;AAAA,IACN,SAAS;AAAA,MACP;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,MACA;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,MACA;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,MACA;AAAA,QACE,cAAc;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,MACR;AAAA,IACF;AAAA,IACA,iBAAiB;AAAA,IACjB,MAAM;AAAA,EACR;AACF;;;ADhCO,SAAS,yBAAkE,OAAsB;AACtG,QAAM,EAAE,MAAM,OAAO,IAAI;AACzB,QAAM;AAAA,IACJ,UAAU,EAAE,QAAQ;AAAA,EACtB,IAAI;AACJ,QAAM,aAAa,KAAK,KAAK,SAAS,CAAC,EAAE,QAAQ,OAAO,OAAO,SAAS,OAAO;AAC/E,YAAU,CAAC,YAAY,yBAAyB;AAChD,SAAO;AAAA,IACL,SAAS,6BAA6B,OAAkB;AAAA,IACxD,KAAK;AAAA,IACL,cAAc;AAAA,IACd,MAAM;AAAA,MACJ,kBAAkB,OAAO,KAAK;AAAA,MAC9B,MAAM,MACH,IAAI,CAAC,SAAS;AACb,YAAIA,UAAS,IAAI,GAAG;AAClB,iBAAO;AAAA,QACT;AACA,YAAI,SAAS,IAAI,GAAG;AAClB,iBAAO;AAAA,QACT;AACA,YAAI,aAAa,IAAI,GAAG;AACtB,gBAAM,aAAa,KAAK,YAAY;AACpC,cAAI,WAAW,SAAS,WAAW,GAAG;AACpC,mBAAO;AAAA,UACT;AACA,cAAI,WAAW,SAAS,WAAW,GAAG;AACpC,mBAAO;AAAA,UACT;AAAA,QACF;AACA,eAAO,CAAC;AAAA,MACV,CAAC,EACA,OAAO,CAAC,UAAU,SAAS,CAAC;AAAA,MAC/B,OAAO;AAAA,IACT;AAAA,EACF;AACF;;;AD1CO,IAAM,cAA0C,OAAO,EAAE,QAAQ,OAAO,MAAM;AACnF,QAAM,CAAC,KAAK,IAAI;AAChB,QAAM,EAAE,QAAQ,KAAK,IAAI;AACzB,QAAM,aAAa,KAAK,KAAK,SAAS,CAAC,EAAE,QAAQ,OAAO,OAAO,SAAS,OAAO;AAC/E,QAAM,UAAU,MAAM,OAAO,UAAU;AAAA,IACrC,WAAW,OAAO,IAAI,CAAC,MAAM;AAC3B,UAAI,UAAU,CAAC,GAAG;AAChB,eAAO,iBAAgC,CAAC;AAAA,MAC1C;AACA,aAAO,yBAAwC,CAAC;AAAA,IAClD,CAAC;AAAA,EACH,CAAC;AAED,SAAO,QAAQ,IAAI,CAAC,QAAQ,MAAM;AAChC,QAAI,OAAO,WAAW,WAAW;AAC/B,cAAQ,MAAM,+BAA+B,OAAO,KAAK;AACzD,aAAO;AAAA,IACT;AACA,UAAM,EAAE,MAAM,YAAY,IAAI,OAAO,CAAC;AACtC,UAAM,cAAc,aAAa,YAAY,CAAC,IAAI,YAAY,YAAY,SAAS,CAAC;AACpF,UAAM,CAAC,OAAO,EAAE,EAAE,cAAc,IAAI,OAAO;AAC3C,WAAO;AAAA,MACL,OAAOC,gBAAe,cAAc,aAAa,KAAK;AAAA,MACtD;AAAA,IACF;AAAA,EACF,CAAC;AACH","sourcesContent":["import { ChainId } from '@pancakeswap/chains'\nimport type { Address } from 'viem'\n\n// = 1 << 23 or 100000000000000000000000\nexport const EMPTY_FEE_PATH_PLACEHOLDER = 8388608\n\nexport const MIXED_ROUTE_QUOTER_ADDRESSES = {\n  [ChainId.ETHEREUM]: '0x678Aa4bF4E210cf2166753e054d5b7c31cc7fa86',\n  [ChainId.GOERLI]: '0xB048Bbc1Ee6b733FFfCFb9e9CeF7375518e25997',\n  [ChainId.BSC]: '0x678Aa4bF4E210cf2166753e054d5b7c31cc7fa86',\n  [ChainId.BSC_TESTNET]: '0xB048Bbc1Ee6b733FFfCFb9e9CeF7375518e25997',\n  [ChainId.ARBITRUM_ONE]: '0x5457fa0318753E9eaC2d17DFfdb6383da207d705',\n  [ChainId.ARBITRUM_GOERLI]: '0x805e03325116Da555Babf012C7bd490Bdd6EEa95',\n  [ChainId.POLYGON_ZKEVM]: '0x4c650FB471fe4e0f476fD3437C3411B1122c4e3B',\n  [ChainId.POLYGON_ZKEVM_TESTNET]: '0x9CFCdecF9e37Bf25023A2B42537127c1089600fE',\n  [ChainId.ZKSYNC]: '0x9B1edFB3848660402E4f1DC25733764e80aA627A',\n  [ChainId.ZKSYNC_TESTNET]: '0x7931c270f59Cb1c2617e87976689bD6803afF50a',\n  [ChainId.LINEA]: '0x4c650FB471fe4e0f476fD3437C3411B1122c4e3B',\n  [ChainId.LINEA_TESTNET]: '0x7d3ed219e45637Cfa77b1a634d0489a2950d1B7F',\n  [ChainId.OPBNB]: '0x4c650FB471fe4e0f476fD3437C3411B1122c4e3B',\n  [ChainId.OPBNB_TESTNET]: '0x118F080BF268aa7De4bE6d5e579D926903E7d6Cb',\n  [ChainId.BASE]: '0x4c650FB471fe4e0f476fD3437C3411B1122c4e3B',\n  [ChainId.BASE_TESTNET]: '0x9d4277f1D41CCB30C0e91f7d1bBA2A739E19032C',\n  [ChainId.SCROLL_SEPOLIA]: '0x9d4277f1D41CCB30C0e91f7d1bBA2A739E19032C',\n  [ChainId.SEPOLIA]: '0x4c650FB471fe4e0f476fD3437C3411B1122c4e3B',\n  [ChainId.ARBITRUM_SEPOLIA]: '0x4c650FB471fe4e0f476fD3437C3411B1122c4e3B',\n  [ChainId.BASE_SEPOLIA]: '0x4c650FB471fe4e0f476fD3437C3411B1122c4e3B',\n  [ChainId.MONAD_TESTNET]: '0x7f988126C2c5d4967Bb5E70bDeB7e26DB6BD5C28',\n} as const satisfies Record<ChainId, Address>\n","import { ChainId } from '@pancakeswap/chains'\nimport type { Address } from 'viem'\n\nexport const V3_QUOTER_ADDRESSES = {\n  [ChainId.ETHEREUM]: '0xB048Bbc1Ee6b733FFfCFb9e9CeF7375518e25997',\n  [ChainId.GOERLI]: '0xbC203d7f83677c7ed3F7acEc959963E7F4ECC5C2',\n  [ChainId.BSC]: '0xB048Bbc1Ee6b733FFfCFb9e9CeF7375518e25997',\n  [ChainId.BSC_TESTNET]: '0xbC203d7f83677c7ed3F7acEc959963E7F4ECC5C2',\n  [ChainId.ARBITRUM_ONE]: '0xB048Bbc1Ee6b733FFfCFb9e9CeF7375518e25997',\n  [ChainId.ARBITRUM_GOERLI]: '0xC0F9488345ed89105b3bd135150905F718Bb254E',\n  [ChainId.POLYGON_ZKEVM]: '0xB048Bbc1Ee6b733FFfCFb9e9CeF7375518e25997',\n  [ChainId.POLYGON_ZKEVM_TESTNET]: '0xA9c08a89Be4503E04Fd84Eadad4320eE34e9B11D',\n  [ChainId.ZKSYNC]: '0x3d146FcE6c1006857750cBe8aF44f76a28041CCc',\n  [ChainId.ZKSYNC_TESTNET]: '0x43e273b4Ffd6bC9d6Be1a862D19893549c3b9b46',\n  [ChainId.LINEA]: '0xB048Bbc1Ee6b733FFfCFb9e9CeF7375518e25997',\n  [ChainId.LINEA_TESTNET]: '0x669254936caE83bE34008BdFdeeA63C902497B31',\n  [ChainId.OPBNB]: '0xB048Bbc1Ee6b733FFfCFb9e9CeF7375518e25997',\n  [ChainId.OPBNB_TESTNET]: '0x052a99849Ef2e13a5CB28275862991671D4b6fF5',\n  [ChainId.BASE]: '0xB048Bbc1Ee6b733FFfCFb9e9CeF7375518e25997',\n  [ChainId.BASE_TESTNET]: '0x6cc56b20bf8C4FfD58050D15AbA2978A745CC691',\n  [ChainId.SCROLL_SEPOLIA]: '0x6cc56b20bf8C4FfD58050D15AbA2978A745CC691',\n  [ChainId.SEPOLIA]: '0xB048Bbc1Ee6b733FFfCFb9e9CeF7375518e25997',\n  [ChainId.ARBITRUM_SEPOLIA]: '0xB048Bbc1Ee6b733FFfCFb9e9CeF7375518e25997',\n  [ChainId.BASE_SEPOLIA]: '0xB048Bbc1Ee6b733FFfCFb9e9CeF7375518e25997',\n  [ChainId.MONAD_TESTNET]: '0x74b06eFA24F39C60AA7F61BD516a3eaf39613D57',\n} as const satisfies Record<ChainId, Address>\n","import { type Hex, encodePacked } from 'viem'\nimport { Token } from '@pancakeswap/swap-sdk-core'\nimport type { Pool } from '@pancakeswap/routing-sdk'\nimport { isV3Pool } from '@pancakeswap/routing-sdk-addon-v3'\n\nimport type { QuoteRoute } from '../types'\nimport { EMPTY_FEE_PATH_PLACEHOLDER } from '../constants'\n\n/**\n * Converts a route to a hex encoded path\n * @param route the mixed path to convert to an encoded path\n * @returns the encoded path\n */\nexport function encodeRouteToPath(route: QuoteRoute, exactOutput: boolean): Hex {\n  const firstInputToken: Token = route.path[0].wrapped\n\n  const { path, types } = route.pools.reduce(\n    (\n      { inputToken, path: p, types: t }: { inputToken: Token; path: (string | number)[]; types: string[] },\n      pool: Pool,\n      index,\n    ): { inputToken: Token; path: (string | number)[]; types: string[] } => {\n      const outputToken = route.path[index + 1].wrapped\n      const fee = isV3Pool(pool) ? pool.getPoolData().fee : EMPTY_FEE_PATH_PLACEHOLDER\n      if (index === 0) {\n        return {\n          inputToken: outputToken,\n          types: ['address', 'uint24', 'address'],\n          path: [inputToken.address, fee, outputToken.address],\n        }\n      }\n      return {\n        inputToken: outputToken,\n        types: [...t, 'uint24', 'address'],\n        path: [...p, fee, outputToken.address],\n      }\n    },\n    { inputToken: firstInputToken, path: [], types: [] },\n  )\n\n  return exactOutput ? encodePacked(types.reverse(), path.reverse()) : encodePacked(types, path)\n}\n","import type { Pool } from '@pancakeswap/routing-sdk'\n\ntype Route<P extends Pool> = {\n  pools: P[]\n}\n\nexport function isMixedRoute<P extends Pool = Pool>({ pools }: Route<P>): boolean {\n  let lastType\n  for (const p of pools) {\n    if (lastType === undefined) {\n      lastType = p.type\n      continue\n    }\n    if (lastType !== p.type) {\n      return true\n    }\n  }\n  return false\n}\n","import type { Pool } from '@pancakeswap/routing-sdk'\nimport { isV3Pool } from '@pancakeswap/routing-sdk-addon-v3'\n\ntype Route<P extends Pool> = {\n  pools: P[]\n}\n\nexport function isV3Route<P extends Pool = Pool>({ pools }: Route<P>): boolean {\n  return pools.every((p) => isV3Pool(p))\n}\n","import { ChainId } from '@pancakeswap/chains'\nimport { StablePool } from '@pancakeswap/routing-sdk-addon-stable-swap'\nimport { V2Pool } from '@pancakeswap/routing-sdk-addon-v2'\nimport { V3Pool } from '@pancakeswap/routing-sdk-addon-v3'\nimport { CurrencyAmount } from '@pancakeswap/swap-sdk-core'\n\nimport { quoterV2ABI } from './abis/IQuoterV2'\nimport { V3_QUOTER_ADDRESSES } from './constants'\nimport type { FetchQuote, QuoteRoute } from './types'\nimport { encodeRouteToPath } from './utils'\n\nexport type SupportedPool = V3Pool | V2Pool | StablePool\n\nexport function buildV3QuoteCall<P extends SupportedPool = SupportedPool>(route: QuoteRoute<P>) {\n  const { path, amount } = route\n  const {\n    currency: { chainId },\n  } = amount\n  const isExactOut = path[path.length - 1].wrapped.equals(amount.currency.wrapped)\n  return {\n    address: V3_QUOTER_ADDRESSES[chainId as ChainId],\n    abi: quoterV2ABI,\n    functionName: isExactOut ? 'quoteExactOutput' : 'quoteExactInput',\n    args: [encodeRouteToPath(route, isExactOut), amount.quotient],\n  } as const\n}\n\nexport const fetchV3Quote: FetchQuote<SupportedPool> = async ({ route, client }) => {\n  const { path, amount } = route\n  const isExactOut = path[path.length - 1].wrapped.equals(amount.currency.wrapped)\n  const result = await client.multicall({\n    contracts: [buildV3QuoteCall<SupportedPool>(route)],\n    allowFailure: false,\n  })\n\n  const [[quote, , , gasUseEstimate]] = result\n  const outCurrency = isExactOut ? path[0] : path[path.length - 1]\n  return {\n    quote: CurrencyAmount.fromRawAmount(outCurrency, quote),\n    gasUseEstimate,\n  }\n}\n","export const quoterV2ABI = [\n  {\n    inputs: [\n      {\n        internalType: 'bytes',\n        name: 'path',\n        type: 'bytes',\n      },\n      {\n        internalType: 'uint256',\n        name: 'amountIn',\n        type: 'uint256',\n      },\n    ],\n    name: 'quoteExactInput',\n    outputs: [\n      {\n        internalType: 'uint256',\n        name: 'amountOut',\n        type: 'uint256',\n      },\n      {\n        internalType: 'uint160[]',\n        name: 'sqrtPriceX96AfterList',\n        type: 'uint160[]',\n      },\n      {\n        internalType: 'uint32[]',\n        name: 'initializedTicksCrossedList',\n        type: 'uint32[]',\n      },\n      {\n        internalType: 'uint256',\n        name: 'gasEstimate',\n        type: 'uint256',\n      },\n    ],\n    stateMutability: 'nonpayable',\n    type: 'function',\n  },\n  {\n    inputs: [\n      {\n        internalType: 'bytes',\n        name: 'path',\n        type: 'bytes',\n      },\n      {\n        internalType: 'uint256',\n        name: 'amountOut',\n        type: 'uint256',\n      },\n    ],\n    name: 'quoteExactOutput',\n    outputs: [\n      {\n        internalType: 'uint256',\n        name: 'amountIn',\n        type: 'uint256',\n      },\n      {\n        internalType: 'uint160[]',\n        name: 'sqrtPriceX96AfterList',\n        type: 'uint160[]',\n      },\n      {\n        internalType: 'uint32[]',\n        name: 'initializedTicksCrossedList',\n        type: 'uint32[]',\n      },\n      {\n        internalType: 'uint256',\n        name: 'gasEstimate',\n        type: 'uint256',\n      },\n    ],\n    stateMutability: 'nonpayable',\n    type: 'function',\n  },\n] as const\n","import { CurrencyAmount } from '@pancakeswap/swap-sdk-core'\n\nimport { SupportedPool, buildV3QuoteCall } from './fetchV3Quote'\nimport { FetchQuotes } from './types'\nimport { isV3Route } from './utils'\nimport { buildMixedRouteQuoteCall } from './fetchMixedRouteQuote'\n\nexport const fetchQuotes: FetchQuotes<SupportedPool> = async ({ routes, client }) => {\n  const [route] = routes\n  const { amount, path } = route\n  const isExactOut = path[path.length - 1].wrapped.equals(amount.currency.wrapped)\n  const results = await client.multicall({\n    contracts: routes.map((r) => {\n      if (isV3Route(r)) {\n        return buildV3QuoteCall<SupportedPool>(r)\n      }\n      return buildMixedRouteQuoteCall<SupportedPool>(r)\n    }),\n  })\n\n  return results.map((result, i) => {\n    if (result.status === 'failure') {\n      console.error('[QUOTER]: fail to get quote', result.error)\n      return undefined\n    }\n    const { path: currentPath } = routes[i]\n    const outCurrency = isExactOut ? currentPath[0] : currentPath[currentPath.length - 1]\n    const [quote, , , gasUseEstimate] = result.result\n    return {\n      quote: CurrencyAmount.fromRawAmount(outCurrency, quote),\n      gasUseEstimate,\n    }\n  })\n}\n","import { ChainId } from '@pancakeswap/chains'\nimport { StablePool, isStablePool } from '@pancakeswap/routing-sdk-addon-stable-swap'\nimport { V2Pool, isV2Pool } from '@pancakeswap/routing-sdk-addon-v2'\nimport { V3Pool, isV3Pool } from '@pancakeswap/routing-sdk-addon-v3'\nimport invariant from 'tiny-invariant'\n\nimport { mixedRouteQuoterV1ABI } from './abis/IMixedRouteQuoterV1'\nimport { MIXED_ROUTE_QUOTER_ADDRESSES } from './constants'\nimport type { QuoteRoute } from './types'\nimport { encodeRouteToPath } from './utils'\n\nexport type SupportedPool = V3Pool | V2Pool | StablePool\n\nexport function buildMixedRouteQuoteCall<P extends SupportedPool = SupportedPool>(route: QuoteRoute<P>) {\n  const { path, amount } = route\n  const {\n    currency: { chainId },\n  } = amount\n  const isExactOut = path[path.length - 1].wrapped.equals(amount.currency.wrapped)\n  invariant(!isExactOut, 'EXACT_OUT_NOT_SUPPORTED')\n  return {\n    address: MIXED_ROUTE_QUOTER_ADDRESSES[chainId as ChainId],\n    abi: mixedRouteQuoterV1ABI,\n    functionName: 'quoteExactInput',\n    args: [\n      encodeRouteToPath(route, false),\n      route.pools\n        .map((pool) => {\n          if (isV3Pool(pool)) {\n            return 0n\n          }\n          if (isV2Pool(pool)) {\n            return 1n\n          }\n          if (isStablePool(pool)) {\n            const stablePool = pool.getPoolData()\n            if (stablePool.balances.length === 2) {\n              return 2n\n            }\n            if (stablePool.balances.length === 3) {\n              return 3n\n            }\n          }\n          return -1n\n        })\n        .filter((index) => index >= 0),\n      amount.quotient,\n    ],\n  } as const\n}\n","export const mixedRouteQuoterV1ABI = [\n  {\n    inputs: [\n      {\n        internalType: 'bytes',\n        name: 'path',\n        type: 'bytes',\n      },\n      {\n        internalType: 'uint256[]',\n        name: 'flag',\n        type: 'uint256[]',\n      },\n      {\n        internalType: 'uint256',\n        name: 'amountIn',\n        type: 'uint256',\n      },\n    ],\n    name: 'quoteExactInput',\n    outputs: [\n      {\n        internalType: 'uint256',\n        name: 'amountOut',\n        type: 'uint256',\n      },\n      {\n        internalType: 'uint160[]',\n        name: 'v3SqrtPriceX96AfterList',\n        type: 'uint160[]',\n      },\n      {\n        internalType: 'uint32[]',\n        name: 'v3InitializedTicksCrossedList',\n        type: 'uint32[]',\n      },\n      {\n        internalType: 'uint256',\n        name: 'v3SwapGasEstimate',\n        type: 'uint256',\n      },\n    ],\n    stateMutability: 'nonpayable',\n    type: 'function',\n  },\n] as const\n"]}