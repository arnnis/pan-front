{"version":3,"sources":["../src/constants/poolType.ts","../src/constants/gasCost.ts","../src/transformer.ts","../src/createV2Pool.ts","../src/utils/isV2Pool.ts"],"names":[],"mappings":"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","sourcesContent":["export const V2_POOL_TYPE = 'V2' as const\n","export const COST_PER_EXTRA_HOP_STABLE_SWAP = 70000n\n\n// Constant cost for doing any swap regardless of pools.\nexport const BASE_SWAP_COST_V2 = 135000n // 115000, bumped up by 20_000\n\n// Constant per extra hop in the route.\nexport const COST_PER_EXTRA_HOP_V2 = 50000n // 20000, bumped up by 30_000\n","import { ChainId } from '@pancakeswap/chains'\nimport { parseCurrencyAmount, toSerializableCurrencyAmount } from '@pancakeswap/routing-sdk'\n\nimport { SerializableV2Pool, V2Pool, V2PoolData } from './types'\nimport { createV2Pool } from './createV2Pool'\n\nexport function toSerializableV2Pool(v2Pool: V2Pool): SerializableV2Pool {\n  const pool = v2Pool.getPoolData()\n  return {\n    ...pool,\n    reserve0: toSerializableCurrencyAmount(pool.reserve0),\n    reserve1: toSerializableCurrencyAmount(pool.reserve1),\n  }\n}\n\nexport function parseV2Pool(chainId: ChainId, pool: SerializableV2Pool): V2Pool {\n  const poolData: V2PoolData = {\n    ...pool,\n    reserve0: parseCurrencyAmount(chainId, pool.reserve0),\n    reserve1: parseCurrencyAmount(chainId, pool.reserve1),\n  }\n\n  return createV2Pool(poolData)\n}\n","import { CurrencyAmount, Price } from '@pancakeswap/swap-sdk-core'\nimport { Pair } from '@pancakeswap/v2-sdk'\n\nimport type { V2Pool, V2PoolData } from './types'\nimport { BASE_SWAP_COST_V2, COST_PER_EXTRA_HOP_V2, V2_POOL_TYPE } from './constants'\n\nexport function createV2Pool(params: V2PoolData): V2Pool {\n  let p = { ...params, type: V2_POOL_TYPE }\n  const getPoolId = (poolData: V2PoolData) => {\n    return Pair.getAddress(poolData.reserve0.currency.wrapped, poolData.reserve1.currency.wrapped)\n  }\n  let address = getPoolId(p)\n\n  const pool: V2Pool = {\n    type: V2_POOL_TYPE,\n    getReserve: (c) => (p.reserve0.currency.wrapped.equals(c.wrapped) ? p.reserve0 : p.reserve1),\n    getCurrentPrice: (base) => {\n      const pair = new Pair(p.reserve0.wrapped, p.reserve1.wrapped)\n      const price = pair.priceOf(base.wrapped)\n      const [baseCurrency, quoteCurrency] = price.baseCurrency.wrapped.equals(p.reserve0.currency.wrapped)\n        ? [p.reserve0.currency, p.reserve1.currency]\n        : [p.reserve1.currency, p.reserve0.currency]\n      return new Price(baseCurrency, quoteCurrency, price.denominator, price.numerator)\n    },\n    getTradingPairs: () => [[p.reserve0.currency, p.reserve1.currency]],\n    getId: () => address,\n    update: (poolData) => {\n      p = { ...p, ...poolData }\n      address = getPoolId(p)\n    },\n    log: () =>\n      `V3 ${p.reserve0.currency.symbol} - ${p.reserve1.currency.symbol} (${address} - price ${pool\n        .getCurrentPrice(p.reserve0.currency, p.reserve1.currency)\n        .toSignificant(6)} ${p.reserve1.currency.symbol}/${p.reserve0.currency.symbol}`,\n\n    getPoolData: () => p,\n\n    getQuote: ({ amount, isExactIn }) => {\n      const pair = new Pair(p.reserve0.wrapped, p.reserve1.wrapped)\n      const quoteCurrency = amount.currency.wrapped.equals(p.reserve0.currency.wrapped)\n        ? p.reserve1.currency\n        : p.reserve0.currency\n      const [quoteAmount, pairAfter] = isExactIn\n        ? pair.getOutputAmount(amount.wrapped)\n        : pair.getInputAmount(amount.wrapped)\n      const quote = CurrencyAmount.fromRawAmount(quoteCurrency, quoteAmount.quotient)\n      const newPool = {\n        ...p,\n        reserve0: CurrencyAmount.fromRawAmount(p.reserve0.currency, pairAfter.reserve0.quotient),\n        reserve1: CurrencyAmount.fromRawAmount(p.reserve1.currency, pairAfter.reserve1.quotient),\n      }\n      return {\n        quote,\n        poolAfter: createV2Pool(newPool),\n        pool,\n      }\n    },\n\n    estimateGasCostForQuote: () => {\n      return BASE_SWAP_COST_V2 + COST_PER_EXTRA_HOP_V2\n    },\n  }\n\n  return pool\n}\n","import type { Pool } from '@pancakeswap/routing-sdk'\n\nimport { V2Pool } from '../types'\nimport { V2_POOL_TYPE } from '../constants'\n\nexport function isV2Pool(p: Pool): p is V2Pool {\n  return p.type === V2_POOL_TYPE\n}\n"]}